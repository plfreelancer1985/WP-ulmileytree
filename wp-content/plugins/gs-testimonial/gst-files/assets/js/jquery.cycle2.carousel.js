/*! carousel transition plugin for Cycle2;  version: 20130528 */
!function(e){"use strict";e(document).on("cycle-bootstrap",(function(e,i,l){"carousel"===i.fx&&(l.getSlideIndex=function(e){var i=this.opts()._carouselWrap.children();return i.index(e)%i.length},l.next=function(){var e=i.reverse?-1:1;!1===i.allowWrap&&i.currSlide+e>i.slideCount-i.carouselVisible||(i.API.advanceSlide(e),i.API.trigger("cycle-next",[i]).log("cycle-next"))})})),e.fn.cycle.transitions.carousel={preInit:function(i){i.hideNonActive=!1,i.container.on("cycle-destroyed",e.proxy(this.onDestroy,i.API)),i.API.stopTransition=this.stopTransition;for(var l=0;l<i.startingSlide;l++)i.container.append(i.slides[0])},postInit:function(i){var l,s,t,r,o=i.carouselVertical;i.carouselVisible&&i.carouselVisible>i.slideCount&&(i.carouselVisible=i.slideCount-1);var n=i.carouselVisible||i.slides.length,c={display:o?"block":"inline-block",position:"static"};if(i.container.css({position:"relative",overflow:"hidden"}),i.slides.css(c),i._currSlide=i.currSlide,r=e('<div class="cycle-carousel-wrap"></div>').prependTo(i.container).css({margin:0,padding:0,top:0,left:0,position:"absolute"}).append(i.slides),i._carouselWrap=r,o||r.css("white-space","nowrap"),!1!==i.allowWrap){for(s=0;s<(void 0===i.carouselVisible?2:1);s++){for(l=0;l<i.slideCount;l++)r.append(i.slides[l].cloneNode(!0));for(l=i.slideCount;l--;)r.prepend(i.slides[l].cloneNode(!0))}r.find(".cycle-slide-active").removeClass("cycle-slide-active"),i.slides.eq(i.startingSlide).addClass("cycle-slide-active")}i.pager&&!1===i.allowWrap&&(t=i.slideCount-n,e(i.pager).children().filter(":gt("+t+")").hide()),i._nextBoundry=i.slideCount-i.carouselVisible,this.prepareDimensions(i)},prepareDimensions:function(i){var l,s,t,r,o=i.carouselVertical,n=i.carouselVisible||i.slides.length;if(i.carouselFluid&&i.carouselVisible?i._carouselResizeThrottle||this.fluidSlides(i):i.carouselVisible&&i.carouselSlideDimension?(l=n*i.carouselSlideDimension,i.container[o?"height":"width"](l)):i.carouselVisible&&(l=n*e(i.slides[0])[o?"outerHeight":"outerWidth"](!0),i.container[o?"height":"width"](l)),s=i.carouselOffset||0,!1!==i.allowWrap)if(i.carouselSlideDimension)s-=(i.slideCount+i.currSlide)*i.carouselSlideDimension;else for(t=i._carouselWrap.children(),r=0;r<i.slideCount+i.currSlide;r++)s-=e(t[r])[o?"outerHeight":"outerWidth"](!0);i._carouselWrap.css(o?"top":"left",s)},fluidSlides:function(i){var l,s=i.slides.eq(0),t=s.outerWidth()-s.width(),r=this.prepareDimensions;function o(){clearTimeout(l),l=setTimeout(n,20)}function n(){i._carouselWrap.stop(!1,!0);var e=i.container.width()/i.carouselVisible;e=Math.ceil(e-t),i._carouselWrap.children().width(e),i._sentinel&&i._sentinel.width(e),r(i)}e(window).on("resize",o),i._carouselResizeThrottle=o,n()},transition:function(i,l,s,t,r){var o,n={},c=i.nextSlide-i.currSlide,a=i.carouselVertical,d=i.speed;if(!1===i.allowWrap){t=c>0;var u=i._currSlide,p=i.slideCount-i.carouselVisible;c>0&&i.nextSlide>p&&u==p?c=0:c>0&&i.nextSlide>p?c=i.nextSlide-u-(i.nextSlide-p):c<0&&i.currSlide>p&&i.nextSlide>p?c=0:c<0&&i.currSlide>p?c+=i.currSlide-p:u=i.currSlide,o=this.getScroll(i,a,u,c),i.API.opts()._currSlide=i.nextSlide>p?p:i.nextSlide}else t&&0===i.nextSlide?(o=this.getDim(i,i.currSlide,a),r=this.genCallback(i,t,a,r)):t||i.nextSlide!=i.slideCount-1?o=this.getScroll(i,a,i.currSlide,c):(o=this.getDim(i,i.currSlide,a),r=this.genCallback(i,t,a,r));n[a?"top":"left"]=t?"-="+o:"+="+o,i.throttleSpeed&&(d=o/e(i.slides[0])[a?"height":"width"]()*i.speed),i._carouselWrap.animate(n,d,i.easing,r)},getDim:function(i,l,s){return e(i.slides[l])[s?"outerHeight":"outerWidth"](!0)},getScroll:function(e,i,l,s){var t,r=0;if(s>0)for(t=l;t<l+s;t++)r+=this.getDim(e,t,i);else for(t=l;t>l+s;t--)r+=this.getDim(e,t,i);return r},genCallback:function(i,l,s,t){return function(){var l=0-e(i.slides[i.nextSlide]).position()[s?"top":"left"]+(i.carouselOffset||0);i._carouselWrap.css(i.carouselVertical?"top":"left",l),t()}},stopTransition:function(){var e=this.opts();e.slides.stop(!1,!0),e._carouselWrap.stop(!1,!0)},onDestroy:function(i){var l=this.opts();l._carouselResizeThrottle&&e(window).off("resize",l._carouselResizeThrottle),l.slides.prependTo(l.container),l._carouselWrap.remove()}}}(jQuery);